
<!DOCTYPE html>
<html lang="en">
    
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="generator" content="">
    <title>Category: java - null</title>
    <meta name="author" content="Moon Star">
    
    
    
    <script type="application/ld+json">{}</script>
    <meta name="description" content="개발 정리 블로그">
<meta property="og:type" content="blog">
<meta property="og:title">
<meta property="og:url" content="https:&#x2F;&#x2F;suld2495.github.io&#x2F;categories&#x2F;java&#x2F;index.html">
<meta property="og:site_name">
<meta property="og:description" content="개발 정리 블로그">
<meta property="og:locale" content="en_US">
<meta property="article:author" content="Moon Star">
<meta name="twitter:card" content="summary">
    
    
        
    
    
    
    
    
    <!--STYLES-->
    
<link rel="stylesheet" href="/assets/css/all.css">

    
<link rel="stylesheet" href="/assets/css/jquery.fancybox.css">

    
<link rel="stylesheet" href="/assets/css/thumbs.css">

    
<link rel="stylesheet" href="/assets/css/tranquilpeak.css">

    <!--STYLES END-->
    

    

    
</head>

    <body>
        <div id="blog">
            <!-- Define author's picture -->


    

<header id="header" data-behavior="2">
    <i id="btn-open-sidebar" class="fa fa-lg fa-bars"></i>
    <div class="header-title">
        <a
            class="header-title-link"
            href="/%20"
            aria-label=""
        >
            
        </a>
    </div>
    
        
            <a
                class="header-right-picture "
                href="#about"
                aria-label="Open the link: /#about"
            >
        
        
        </a>
    
</header>

            <!-- Define author's picture -->


<nav id="sidebar" data-behavior="2">
    <div class="sidebar-container">
        
        
            <ul class="sidebar-buttons">
            
                <li class="sidebar-button">
                    
                        <a  class="sidebar-button-link "
                             href="/%20"
                            
                            title="홈"
                        >
                    
                        <i class="sidebar-button-icon fa fa-home" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">홈</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a  class="sidebar-button-link "
                             href="/all-categories"
                            
                            title="카테고리"
                        >
                    
                        <i class="sidebar-button-icon fa fa-bookmark" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">카테고리</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a  class="sidebar-button-link "
                             href="/all-tags"
                            
                            title="태그"
                        >
                    
                        <i class="sidebar-button-icon fa fa-tags" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">태그</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a  class="sidebar-button-link "
                             href="/all-archives"
                            
                            title="아카이브"
                        >
                    
                        <i class="sidebar-button-icon fa fa-archive" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">아카이브</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a  class="sidebar-button-link open-algolia-search"
                             href="#search"
                            
                            title="검색"
                        >
                    
                        <i class="sidebar-button-icon fa fa-search" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">검색</span>
                    </a>
            </li>
            
        </ul>
        
            <ul class="sidebar-buttons">
            
                <li class="sidebar-button">
                    
                        <a  class="sidebar-button-link " href="https://github.com/" target="_blank" rel="noopener" title="GitHub">
                    
                        <i class="sidebar-button-icon fab fa-github" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">GitHub</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a  class="sidebar-button-link " href="https://facebook.com/" target="_blank" rel="noopener" title="Facebook">
                    
                        <i class="sidebar-button-icon fab fa-facebook" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Facebook</span>
                    </a>
            </li>
            
        </ul>
        
            <ul class="sidebar-buttons">
            
                <li class="sidebar-button">
                    
                        <a  class="sidebar-button-link "
                             href="/atom.xml"
                            
                            title="RSS"
                        >
                    
                        <i class="sidebar-button-icon fa fa-rss" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">RSS</span>
                    </a>
            </li>
            
        </ul>
        
    </div>
</nav>

            
            <div id="main" data-behavior="2"
                 class="
                        hasCoverMetaIn
                        ">
                
    <section class="postShorten-group main-content-wrap">
    
    
    <article class="postShorten postShorten--thumbnailimg-bottom">
        <div class="postShorten-wrap">
            
            <div class="postShorten-header">
                <h1 class="postShorten-title">
                    
                        <a
                            class="link-unstyled"
                            href="/2020/01/13/java-cors/"
                            aria-label=": CORS 크로스 도메인 이슈"
                        >
                            CORS 크로스 도메인 이슈
                        </a>
                    
                </h1>
                <div class="postShorten-meta">
    <time datetime="2020-01-13T08:25:57+09:00">
	
		    Jan 13, 2020
    	
    </time>
    
        <span>in </span>
        
    <a class="category-link" href="/categories/java/">java</a>, <a class="category-link" href="/categories/java/server/">server</a>


    
</div>

            </div>
            
                <div class="postShorten-content">
                    <h2 id="CORS란"><a href="#CORS란" class="headerlink" title="CORS란"></a>CORS란</h2><p>CORS란 도메인 또는 포트가 다른 서버의 자원을 요청하는 매커니즘을 말합니다. 이때 요청을 할때는 corss-origin HTTP에 의해 요청됩니다.<br><br><br>이때 요청을 할때는 cross-origin HTTP에 의해 요청됩니다.<br><br><br>하지만 동일 출처 정책 때문에 CORS 상황이 발생시에 요청한 데이터를 브라우저에서 보안목적으로 차단합니다. 해당 문제를 해결하는 가장 쉬운 방법은 같은 도메인을 사용하는 것입니다. 하지만 요즘에는 각기 다른 용도로 사용되는 경우에는 개별 서버를 구축하기 때문에 이는 해결책이 될수 없습니다.<br><br><br>다른 해결방법은 서버에서 CORS 효청을 허용해주면 됩니다. 서버로 들어오는 모든 요청에 대해서 CORS 요청을 허용하기 위해서 Filter를 이용합니다. </p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CORSFilter</span> <span class="keyword">implements</span> <span class="title">Filter</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">doFilter</span><span class="params">(ServletRequest req, ServletResponse res, FilterChain chain)</span></span></span><br><span class="line"><span class="function">			<span class="keyword">throws</span> IOException, ServletException </span>&#123;</span><br><span class="line">        HttpServletResponse response = (HttpServletResponse) res;</span><br><span class="line"></span><br><span class="line">        response.setHeader(<span class="string">"Access-Control-Allow-Origin"</span>, <span class="string">"*"</span>);</span><br><span class="line">        response.setHeader(<span class="string">"Access-Control-Allow-Methods"</span>, <span class="string">"POST, GET, OPTIONS"</span>);</span><br><span class="line">        response.setHeader(<span class="string">"Access-Control-Allow-Origin"</span>, <span class="string">"3600"</span>);</span><br><span class="line">        response.setHeader(<span class="string">"Access-Control-Allow-Origin"</span>, <span class="string">"x-auth-token, x-requested-with, origin, content-type, accept, sid"</span>);</span><br><span class="line"></span><br><span class="line">        chain.doFilter(req, res);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">filter</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">filter-name</span>&gt;</span>cors<span class="tag">&lt;/<span class="name">filter-name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">filter-class</span>&gt;</span>kr.co.spring.filter.SimpleCORSFilter<span class="tag">&lt;/<span class="name">filter-class</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">filter</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">filter-mapping</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">filter-name</span>&gt;</span>cors<span class="tag">&lt;/<span class="name">filter-name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/*<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">filter-mapping</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h5 id="Access-Control-Allow-Methods"><a href="#Access-Control-Allow-Methods" class="headerlink" title="Access-Control-Allow-Methods"></a>Access-Control-Allow-Methods</h5><p>POST, PUT, DELETE 등 허용할 ACCESS METHOD를 설정할수 있습니다. </p>
<h5 id="Access-Control-Max-Age"><a href="#Access-Control-Max-Age" class="headerlink" title="Access-Control-Max-Age"></a>Access-Control-Max-Age</h5><p>HTTP Request 요청에 앞서 Preflight Request 라는 요청이 발생되는데, 이는 해당 서버에 요청하는 메소드가 실행 가능한지(권한 여부) 확인을 위한 요청입니다. Preflight Reuqest는 OPTIONS 메소드를 통해 서버에 전달됩니다(Allow-Methods 설정에서 OPTIONS를 허용해야 합니다).<br><br><br>Access-Control-Max-Age는 Preflight Request를 캐시할 시간입니다. 단위는 초입니다. 캐시를 하게 된다면 해당 시간이 지난 뒤에 재 요청을 하게 됩니다.</p>
<h5 id="Access-Control-Allow-Origin"><a href="#Access-Control-Allow-Origin" class="headerlink" title="Access-Control-Allow-Origin"></a>Access-Control-Allow-Origin</h5><p>허용할 도메인을 설정할수 있습니다. 값은 *로 설정하면 모든 도메인에서 허용하는 것이고, 특정 도메인만 설정할수 있습니다. </p>

                    
                        


                    
                    
                        <p>
                            <a
                                href="/2020/01/13/java-cors/#post-footer"
                                class="postShorten-excerpt_link link"
                                aria-label=""
                            >
                                Comment and share
                            </a>
                        </p>
                    
                </div>
            
        </div>
        
    </article>
    
    
    <article class="postShorten postShorten--thumbnailimg-bottom">
        <div class="postShorten-wrap">
            
            <div class="postShorten-header">
                <h1 class="postShorten-title">
                    
                        <a
                            class="link-unstyled"
                            href="/2019/12/20/java-junit5/"
                            aria-label=": 스프링 테스트"
                        >
                            스프링 테스트
                        </a>
                    
                </h1>
                <div class="postShorten-meta">
    <time datetime="2019-12-20T17:43:23+09:00">
	
		    Dec 20, 2019
    	
    </time>
    
        <span>in </span>
        
    <a class="category-link" href="/categories/java/">java</a>, <a class="category-link" href="/categories/java/junit/">junit</a>


    
</div>

            </div>
            
                <div class="postShorten-content">
                    <h2 id="Spring-Test"><a href="#Spring-Test" class="headerlink" title="Spring-Test"></a>Spring-Test</h2><p>스프링은 Junit을 이용하는 테스트 컨텍스트 프레임워크를 제공한다. 이를 이용하면 어노테이션을 이용하여 간편하게 컨텍스트를 사용할수 있다. 해당 방법이 없이 Bean을 사용하려면 직접 ApplicationContext를 생성하는 번거로운 작업을 진행하여야 하나 이로 인해 편하게 작업을 진행 할수 있다.</p>
<h2 id="ContextConfiguration"><a href="#ContextConfiguration" class="headerlink" title="@ContextConfiguration"></a>@ContextConfiguration</h2>
                    
                        


                    
                    
                        <p>
                            <a
                                href="/2019/12/20/java-junit5/#post-footer"
                                class="postShorten-excerpt_link link"
                                aria-label=""
                            >
                                Comment and share
                            </a>
                        </p>
                    
                </div>
            
        </div>
        
    </article>
    
    
    <article class="postShorten postShorten--thumbnailimg-bottom">
        <div class="postShorten-wrap">
            
            <div class="postShorten-header">
                <h1 class="postShorten-title">
                    
                        <a
                            class="link-unstyled"
                            href="/2019/12/20/java-datasourceutils/"
                            aria-label=": DataSourceUtils"
                        >
                            DataSourceUtils
                        </a>
                    
                </h1>
                <div class="postShorten-meta">
    <time datetime="2019-12-20T16:23:25+09:00">
	
		    Dec 20, 2019
    	
    </time>
    
        <span>in </span>
        
    <a class="category-link" href="/categories/java/">java</a>, <a class="category-link" href="/categories/java/api/">api</a>


    
</div>

            </div>
            
                <div class="postShorten-content">
                    <h2 id="DataSource"><a href="#DataSource" class="headerlink" title="DataSource"></a>DataSource</h2><p>DataSource는 ConnectionPool을 관리하기 위한 목적으로 사용되는 객체로 DataSource를 통해서 Connection을 얻어오고 반납하는 등의 작업을 구현합니다. ConnectionPool에는 여러개의 Connection 객체가 생성되어 운용되는데, 이를 직접 웹 어플리케이션에서 다루기 힘들기 때문에 DataSource라는 개념이 도입되었습니다.</p>
<h2 id="DataSourceUtils"><a href="#DataSourceUtils" class="headerlink" title="DataSourceUtils"></a>DataSourceUtils</h2><p>DataSourceUtils 클래스는 JNDI에서 연결을 얻고 필요한 경우 연결을 닫는 메소드를 제공하는 기능을 제공 합니다. 그리고 DataSourceTransactionManager로 쓰레드에 기반한 연결을 지원합니다.</p>
<h2 id="DataSourceUtils에서-제공하는-메소드"><a href="#DataSourceUtils에서-제공하는-메소드" class="headerlink" title="DataSourceUtils에서 제공하는 메소드"></a>DataSourceUtils에서 제공하는 메소드</h2><h5 id="getConnection-DataSource-dataSource"><a href="#getConnection-DataSource-dataSource" class="headerlink" title="getConnection(DataSource dataSource)"></a>getConnection(DataSource dataSource)</h5><p>getConnection메소드는 제공 된 DataSource를 기반으로 하여 Connection을 생성해줍니다. Connection 생성은 트랜잭션 동기화 여부에 따라 다르게 작동합니다. 만약 트랜잭션 동기화가 활성화 되어 있다면 Connection을 생성하고 트랜잭션 저장소에 바인딩 합니다. 이후 트랜잭션 동기화 작업을 종료 할때까지 getConnection메소드를 호출하면 동일한 Connection을 반환하는 것을 확인할수 있습니다.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">DataSourceUtilsTest</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    DataSource dataSource;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testGetConnection</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        TransactionSynchronizationManager.initSynchronization();</span><br><span class="line"></span><br><span class="line">        Connection conn1 = DataSourceUtils.getConnection(dataSource);</span><br><span class="line">        Connection conn2 = DataSourceUtils.getConnection(dataSource);</span><br><span class="line"></span><br><span class="line">        System.out.println(<span class="string">"동일한 인스턴스 인가요? "</span> + conn1.equals(conn2));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="/image/java-datasourceutils1.png" alt=""></p>
<p>트랜잭션이 동기화되어 있지 않을 경우에는 <code>dataSource.getConnection()</code>과 동일하게 작동합니다. 그래서 항상 새로운 Connection을 반환합니다.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">DataSourceUtilsTest</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    DataSource dataSource;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testGetConnection</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        Connection conn1 = DataSourceUtils.getConnection(dataSource);</span><br><span class="line">        Connection conn2 = DataSourceUtils.getConnection(dataSource);</span><br><span class="line"></span><br><span class="line">        System.out.println(<span class="string">"동일한 인스턴스 인가요? "</span> + conn1.equals(conn2));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="/image/java-datasourceutils2.PNG" alt=""></p>
<h5 id="releaseConnection-Connection-conn-DataSource-dataSource"><a href="#releaseConnection-Connection-conn-DataSource-dataSource" class="headerlink" title="releaseConnection(Connection conn, DataSource dataSource)"></a>releaseConnection(Connection conn, DataSource dataSource)</h5><p>releaseConnection메소드 또한 getConnection와 비슷하게 동작 합니다. 만약 트랜잭션 동기화가 활성화 되어 있다면 트랜잭션 저장소에서 Connection을 초기화 합니다. 이때 Connection의 연결은 종료하지 않습니다. 그리고 release 후 다시 getConnection으로 Connection을 받아왔을때 동일한 값이라는 것을 확인 할수 있습니다.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">DataSourceUtilsTest</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    DataSource dataSource;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testGetConnection</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        TransactionSynchronizationManager.initSynchronization();</span><br><span class="line"></span><br><span class="line">        Connection conn = DataSourceUtils.getConnection(dataSource);</span><br><span class="line"></span><br><span class="line">        DataSourceUtils.releaseConnection(conn, dataSource);</span><br><span class="line">        System.out.println(<span class="string">"Connection이 종료 되었니? "</span> + conn.isClosed());</span><br><span class="line"></span><br><span class="line">        Connection conn2 = DataSourceUtils.getConnection(dataSource);</span><br><span class="line"></span><br><span class="line">        System.out.println(<span class="string">"동일한 Connection 인가요? "</span> + conn.equals(conn2));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="/image/java-datasourceutils3.PNG" alt=""></p>
<p>위와 같이 releaseConnection 메소드를 호출 하더라도 Connection은 종료되지 않는다. 단지 트랜잭션에서만 제거되었을 뿐이다. 이 때문에 사용시 주의할 필요가 있다.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">DataSourceUtilsTest</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    DataSource dataSource;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testGetConnection</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        TransactionSynchronizationManager.initSynchronization();</span><br><span class="line"></span><br><span class="line">        Connection conn = DataSourceUtils.getConnection(dataSource);</span><br><span class="line"></span><br><span class="line">        System.out.println(<span class="string">"트랜잭션 저장소에 저장 중인가? "</span> + DataSourceUtils.isConnectionTransactional(conn, dataSource));</span><br><span class="line"></span><br><span class="line">        DataSourceUtils.releaseConnection(conn, dataSource);</span><br><span class="line"></span><br><span class="line">        TransactionSynchronizationManager.unbindResource(dataSource);</span><br><span class="line">        TransactionSynchronizationManager.clearSynchronization();</span><br><span class="line"></span><br><span class="line">        System.out.println(<span class="string">"Connection이 종료 되었니? "</span> + conn.isClosed());</span><br><span class="line">        System.out.println(<span class="string">"트랜잭션 저장소에 저장 중인가? "</span> + DataSourceUtils.isConnectionTransactional(conn, dataSource));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="/image/java-datasourceutils4.PNG" alt=""></p>
<h2 id="결론"><a href="#결론" class="headerlink" title="결론"></a>결론</h2><p>DataSourceUtils를 사용하면 동기화된 트랜잭션의 Connection을 가져와서 사용하기에 좋다. 하지만 releaseConnection은 Connection을 종료해주는 기능이 아니므로 사용시에 주의할 필요가 있다.</p>
<div class="alert info"><p>트랜잭션 동기화 상태가 아닌 Connection이라면 releaseConnection메소드를 호출하면 close 해준다.</p>
</div>
                    
                        


                    
                    
                        <p>
                            <a
                                href="/2019/12/20/java-datasourceutils/#post-footer"
                                class="postShorten-excerpt_link link"
                                aria-label=""
                            >
                                Comment and share
                            </a>
                        </p>
                    
                </div>
            
        </div>
        
    </article>
    
    
    <article class="postShorten postShorten--thumbnailimg-bottom">
        <div class="postShorten-wrap">
            
            <div class="postShorten-header">
                <h1 class="postShorten-title">
                    
                        <a
                            class="link-unstyled"
                            href="/2019/12/19/java-json/"
                            aria-label=": json 파일 입출력"
                        >
                            json 파일 입출력
                        </a>
                    
                </h1>
                <div class="postShorten-meta">
    <time datetime="2019-12-19T01:01:32+09:00">
	
		    Dec 19, 2019
    	
    </time>
    
        <span>in </span>
        
    <a class="category-link" href="/categories/java/">java</a>, <a class="category-link" href="/categories/java/input-output/">input / output</a>


    
</div>

            </div>
            
                <div class="postShorten-content">
                    <h2 id="JSON파일-출력-파일-작성"><a href="#JSON파일-출력-파일-작성" class="headerlink" title="JSON파일 출력(파일 작성)"></a>JSON파일 출력(파일 작성)</h2><h3 id="소스코드"><a href="#소스코드" class="headerlink" title="소스코드"></a>소스코드</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">writeJSON</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    String jsonString = <span class="string">"json파일에 저장할 내용"</span>,</span><br><span class="line">           path = <span class="string">"C:/json/"</span>,</span><br><span class="line">           fileName = <span class="string">"jsonTest.json"</span>;</span><br><span class="line"></span><br><span class="line">    FileWriter fileWriter = <span class="keyword">null</span>;</span><br><span class="line"></span><br><span class="line">    File dirFile = <span class="keyword">new</span> File(path),</span><br><span class="line">         fullFile = <span class="keyword">new</span> File(path + fileName);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (!dirFile.exists()) &#123;</span><br><span class="line">        dirFile.mkdirs();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        fileWriter = <span class="keyword">new</span> FileWriter(fullFile);</span><br><span class="line">        fileWriter.write(jsonString);</span><br><span class="line">        fileWriter.flush();</span><br><span class="line">    &#125; <span class="keyword">catch</span>(Exception e) &#123;</span><br><span class="line"></span><br><span class="line">    &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">        fileWriter.close();</span><br><span class="line">    &#125;    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="설명"><a href="#설명" class="headerlink" title="설명"></a>설명</h3><p>json파일을 작성하는 것은 기타 다른 파일을 작성하는 것과 별반 차이가 없다. 예제에서는 일반 string문자열을 저장하고 있지만 실제 JSON 데이터를 저장할 때도 JSONData를 JSONString으로 변환후에 저장하면 된다.</p>
<h2 id="JSON파일-호출"><a href="#JSON파일-호출" class="headerlink" title="JSON파일 호출"></a>JSON파일 호출</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> com.google.gson.Gson;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">readJSON</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    String path = <span class="string">"C:/json/"</span>,</span><br><span class="line">           fileName = <span class="string">"jsonTest.json"</span>;</span><br><span class="line"></span><br><span class="line">    JsonParser jsonParser = <span class="keyword">new</span> JsonParser();</span><br><span class="line"></span><br><span class="line">    FileReader fileReader = <span class="keyword">null</span>;</span><br><span class="line"></span><br><span class="line">    File file = <span class="keyword">new</span> File(path + fileName);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (file.isFile()) &#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> Exception(<span class="string">"존재하지 않는 파일입니다."</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        fileReader = <span class="keyword">new</span> FileReader(file);  <span class="comment">// 1. FileReader 인스턴스를 생성합니다.</span></span><br><span class="line"></span><br><span class="line">        Object resultObj = gson.fromJson(fileReader, Object<span class="class">.<span class="keyword">class</span>)</span>;    <span class="comment">// gson의 fromJson메서드의 첫번째 파라미터로는 Reader를 두번째 파라미터로는 Json 데이터 타입을 넘겨주면 된다.</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">// Map map = (Map) gson.fromJson(fileReader, Object.class);     // 타입을 Object로 하고 casting 가능</span></span><br><span class="line">        <span class="comment">// Map map = gson.fromJson(fileReader, Map.class);  // 타입을 바로 Map으로 해서 casting 없이 사용 가능</span></span><br><span class="line">    &#125; <span class="keyword">catch</span>(Exception e) &#123;</span><br><span class="line"></span><br><span class="line">    &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">        fileReader.close();</span><br><span class="line">    &#125;   </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


<h3 id="설명-1"><a href="#설명-1" class="headerlink" title="설명"></a>설명</h3><p>해당 소스코드는 구글에서 제공하는 Gson을 이용해서 parse를 한다. Gson의 fromJson은 첫번째 파라미터로 Reader와 두번째 파라미터로 데이터 타입을 받는다. 두번째 파라미터로 Object.class를 넘겨주니 모든 데이터 타입(원시 타입 포함)의 값을 오류없이 가져올수 있었다.</p>
<blockquote>
<p>gson.fromJson(Reader, Type) : JSON 파일로 부터 데이터 가져오기<br>gson.fromJson(String, type) : JSONString 으로부터 각 데이터 타입으로 변환</p>
</blockquote>

                    
                        


                    
                    
                        <p>
                            <a
                                href="/2019/12/19/java-json/#post-footer"
                                class="postShorten-excerpt_link link"
                                aria-label=""
                            >
                                Comment and share
                            </a>
                        </p>
                    
                </div>
            
        </div>
        
    </article>
    
    
    <article class="postShorten postShorten--thumbnailimg-bottom">
        <div class="postShorten-wrap">
            
            <div class="postShorten-header">
                <h1 class="postShorten-title">
                    
                        <a
                            class="link-unstyled"
                            href="/2019/12/19/java-gson/"
                            aria-label=": gson을 이용한 입출력"
                        >
                            gson을 이용한 입출력
                        </a>
                    
                </h1>
                <div class="postShorten-meta">
    <time datetime="2019-12-19T00:57:27+09:00">
	
		    Dec 19, 2019
    	
    </time>
    
        <span>in </span>
        
    <a class="category-link" href="/categories/java/">java</a>, <a class="category-link" href="/categories/java/input-output/">input / output</a>


    
</div>

            </div>
            
                <div class="postShorten-content">
                    <h2 id="1-json-출력"><a href="#1-json-출력" class="headerlink" title="1. json 출력"></a>1. json 출력</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">Map&lt;String, Object&gt; map = <span class="keyword">new</span> HashMap&lt;String, Object&gt;();</span><br><span class="line">map.put(<span class="string">"id"</span>, <span class="string">"아이언맨"</span>);</span><br><span class="line">map.put(<span class="string">"name"</span>, <span class="string">"어벤저스"</span>);</span><br><span class="line"></span><br><span class="line">Gson gson = <span class="keyword">new</span> Gson();</span><br><span class="line"></span><br><span class="line">String path = <span class="string">"C:\\test\\test1.json"</span>;</span><br><span class="line"></span><br><span class="line">BufferedWriter writer = <span class="keyword">new</span> BufferedWriter(<span class="keyword">new</span> OutputStreamWriter(<span class="keyword">new</span> FileOutputStream(path), <span class="string">"UTF-8"</span>));</span><br><span class="line">writer.write(gson.toJson(map, Map<span class="class">.<span class="keyword">class</span>))</span>;</span><br><span class="line">writer.close();</span><br></pre></td></tr></table></figure>

<h2 id="2-json-입력"><a href="#2-json-입력" class="headerlink" title="2. json 입력"></a>2. json 입력</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">Gson gson = <span class="keyword">new</span> Gson();</span><br><span class="line"></span><br><span class="line">String path = <span class="string">"C:\\test\\test1.json"</span>;</span><br><span class="line"></span><br><span class="line">BufferedReader reader = <span class="keyword">new</span> BufferedReader(<span class="keyword">new</span> InputStreamReader(<span class="keyword">new</span> FileInputStream(path), <span class="string">"UTF-8"</span>));</span><br><span class="line"></span><br><span class="line">Map&lt;String, Object&gt; map = gson.fromJson(reader, Map<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line"></span><br><span class="line">System.out.println(map);</span><br></pre></td></tr></table></figure>

<blockquote>
<p>json의 입력은 Gson을 사용하면 간편하게 처리할수 있다</p>
</blockquote>

                    
                        


                    
                    
                        <p>
                            <a
                                href="/2019/12/19/java-gson/#post-footer"
                                class="postShorten-excerpt_link link"
                                aria-label=""
                            >
                                Comment and share
                            </a>
                        </p>
                    
                </div>
            
        </div>
        
    </article>
    
    
    <article class="postShorten postShorten--thumbnailimg-bottom">
        <div class="postShorten-wrap">
            
            <div class="postShorten-header">
                <h1 class="postShorten-title">
                    
                        <a
                            class="link-unstyled"
                            href="/2019/12/19/java-text-inoutput/"
                            aria-label=": 텍스트파일 입출력"
                        >
                            텍스트파일 입출력
                        </a>
                    
                </h1>
                <div class="postShorten-meta">
    <time datetime="2019-12-19T00:54:42+09:00">
	
		    Dec 19, 2019
    	
    </time>
    
        <span>in </span>
        
    <a class="category-link" href="/categories/java/">java</a>, <a class="category-link" href="/categories/java/input-output/">input / output</a>


    
</div>

            </div>
            
                <div class="postShorten-content">
                    <h2 id="1-텍스트-파일-출력"><a href="#1-텍스트-파일-출력" class="headerlink" title="1. 텍스트 파일 출력"></a>1. 텍스트 파일 출력</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">String path = <span class="string">"./test.txt"</span>,</span><br><span class="line">       text = <span class="string">"안녕하세요\n"</span></span><br><span class="line">            + <span class="string">"어서오세요\n"</span></span><br><span class="line">            + <span class="string">"인사합니다"</span>;</span><br><span class="line"></span><br><span class="line">BufferedWriter writer = <span class="keyword">new</span> BufferedWriter(</span><br><span class="line">    <span class="keyword">new</span> OutputStreamWriter(<span class="keyword">new</span> FileOutputStream(path), <span class="string">"UTF-8"</span>));</span><br><span class="line"></span><br><span class="line">writer.write(text);</span><br><span class="line">writer.close();</span><br></pre></td></tr></table></figure>

<h2 id="2-텍스트-파일-입력"><a href="#2-텍스트-파일-입력" class="headerlink" title="2. 텍스트 파일 입력"></a>2. 텍스트 파일 입력</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">String path = <span class="string">"./test.txt"</span>,</span><br><span class="line">       str  = <span class="string">""</span>;</span><br><span class="line"></span><br><span class="line">StringBuilder sb = <span class="keyword">new</span> StringBuilder();</span><br><span class="line"></span><br><span class="line">BufferedReader reader = <span class="keyword">new</span> BufferedReader(</span><br><span class="line">    <span class="keyword">new</span> InputStreamReader(<span class="keyword">new</span> FileInputStream(path), <span class="string">"UTF-8"</span>));</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span>((str = reader.readLine()) != <span class="keyword">null</span>) &#123;</span><br><span class="line">    sb.append(str);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>FileReader/FileWriter는 인코딩 설정이 불가능 하므로 FileInputStream/FileOuputStream을 쓰자<br>많은 양의 데이터를 입출력 할시에 Buffer를 쓰는것과 안 쓰는것의 차이가 크다 =&gt; 버퍼를 쓰자<br>InputStream/OutputStream은 단위가 바이트단위라서 한글이 깨지므로 InputStreamReader/OutputStreamReader를 쓰자</p>

                    
                        


                    
                    
                        <p>
                            <a
                                href="/2019/12/19/java-text-inoutput/#post-footer"
                                class="postShorten-excerpt_link link"
                                aria-label=""
                            >
                                Comment and share
                            </a>
                        </p>
                    
                </div>
            
        </div>
        
    </article>
    
    
    <article class="postShorten postShorten--thumbnailimg-bottom">
        <div class="postShorten-wrap">
            
            <div class="postShorten-header">
                <h1 class="postShorten-title">
                    
                        <a
                            class="link-unstyled"
                            href="/2019/12/19/java-list/"
                            aria-label=": 리스트(List)"
                        >
                            리스트(List)
                        </a>
                    
                </h1>
                <div class="postShorten-meta">
    <time datetime="2019-12-19T00:51:14+09:00">
	
		    Dec 19, 2019
    	
    </time>
    
        <span>in </span>
        
    <a class="category-link" href="/categories/java/">java</a>, <a class="category-link" href="/categories/java/collection/">collection</a>


    
</div>

            </div>
            
                <div class="postShorten-content">
                    <h2 id="1-리스트의-메서드"><a href="#1-리스트의-메서드" class="headerlink" title="1. 리스트의 메서드"></a>1. 리스트의 메서드</h2><h3 id="retainAll-Collection"><a href="#retainAll-Collection" class="headerlink" title=".retainAll(Collection)"></a>.retainAll(Collection)</h3><p>List와 Collection에서 중복되는 값만 남기고 모두 삭제한다. 결과는 바로 List에 적용 된다</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">List list1 &#x3D; new ArrayList();</span><br><span class="line">List list2 &#x3D; new ArrayList();</span><br><span class="line"></span><br><span class="line">list1.add(&quot;아이언맨&quot;);</span><br><span class="line">list1.add(&quot;헐크&quot;);</span><br><span class="line"></span><br><span class="line">list2.add(&quot;아이언맨&quot;);</span><br><span class="line">list2.add(&quot;윈터솔져&quot;);</span><br><span class="line"></span><br><span class="line">list1.retainAll(list2);</span><br><span class="line"></span><br><span class="line">System.out.println(list1);  &#x2F;&#x2F; [아이언맨]</span><br></pre></td></tr></table></figure>

<h3 id="removeAll"><a href="#removeAll" class="headerlink" title=".removeAll()"></a>.removeAll()</h3><p>List와 Collection에서 중복되는 내용을 모두 삭제한다. 결과는 바로 List에 적용 된다</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">List list1 &#x3D; new ArrayList();</span><br><span class="line">List list2 &#x3D; new ArrayList();</span><br><span class="line"></span><br><span class="line">list1.add(&quot;아이언맨&quot;);</span><br><span class="line">list1.add(&quot;헐크&quot;);</span><br><span class="line"></span><br><span class="line">list2.add(&quot;아이언맨&quot;);</span><br><span class="line">list2.add(&quot;윈터솔져&quot;);</span><br><span class="line"></span><br><span class="line">list1.removeAll(list2);</span><br><span class="line"></span><br><span class="line">System.out.println(list1);  &#x2F;&#x2F; [헐크]</span><br></pre></td></tr></table></figure>

<h2 id="2-List와-Array-변환"><a href="#2-List와-Array-변환" class="headerlink" title="2. List와 Array 변환"></a>2. List와 Array 변환</h2><h3 id="List-gt-Array로-변환"><a href="#List-gt-Array로-변환" class="headerlink" title="List =&gt; Array로 변환"></a>List =&gt; Array로 변환</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">List&lt;String&gt; list &#x3D; new ArrayList&lt;String&gt;();</span><br><span class="line"></span><br><span class="line">String[] array &#x3D; list.toArray();</span><br></pre></td></tr></table></figure>

<h3 id="Array-gt-List로-변환"><a href="#Array-gt-List로-변환" class="headerlink" title="Array =&gt; List로 변환"></a>Array =&gt; List로 변환</h3><p>이건 배열 자체적인 기능은 제공하지 않아서 배열 util인 Arrays의 asList메서드를 활용한다</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">String[] array &#x3D; new String[3];</span><br><span class="line"></span><br><span class="line">List&lt;String&gt; list &#x3D; Arrays.asList(array);</span><br></pre></td></tr></table></figure>
                    
                        


                    
                    
                        <p>
                            <a
                                href="/2019/12/19/java-list/#post-footer"
                                class="postShorten-excerpt_link link"
                                aria-label=""
                            >
                                Comment and share
                            </a>
                        </p>
                    
                </div>
            
        </div>
        
    </article>
    
    <div class="pagination-bar">
    <ul class="pagination">
        
        
        <li class="pagination-number">page 1 of 1</li>
    </ul>
</div>

</section>



                <footer id="footer" class="main-content-wrap">
    <span class="copyrights">
        Copyrights &copy; 2020 Moon Star. All Rights Reserved.
    </span>
</footer>

            </div>
            
        </div>
        


<div id="about">
    <div id="about-card">
        <div id="about-btn-close">
            <i class="fa fa-times"></i>
        </div>
        
            <h4 id="about-card-name">Moon Star</h4>
        
            <div id="about-card-bio"><p>author.bio</p>
</div>
        
        
            <div id="about-card-job">
                <i class="fa fa-briefcase"></i>
                <br/>
                <p>author.job</p>

            </div>
        
        
    </div>
</div>

        
        
<div id="cover" style="background-image:url('/assets/images/cover.jpg');"></div>
        <!--SCRIPTS-->

<script src="/assets/js/jquery.js"></script>


<script src="/assets/js/jquery.fancybox.js"></script>


<script src="/assets/js/thumbs.js"></script>


<script src="/assets/js/tranquilpeak.js"></script>

<!--SCRIPTS END-->





    </body>
</html>
