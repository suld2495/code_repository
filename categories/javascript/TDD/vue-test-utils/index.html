
<!DOCTYPE html>
<html lang="en">
    
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="generator" content="">
    <title>Category: vue-test-utils - null</title>
    <meta name="author" content="Moon Star">
    
    
    
    <script type="application/ld+json">{}</script>
    <meta name="description" content="개발 정리 블로그">
<meta property="og:type" content="blog">
<meta property="og:title">
<meta property="og:url" content="https:&#x2F;&#x2F;suld2495.github.io&#x2F;categories&#x2F;javascript&#x2F;TDD&#x2F;vue-test-utils&#x2F;index.html">
<meta property="og:site_name">
<meta property="og:description" content="개발 정리 블로그">
<meta property="og:locale" content="en_US">
<meta property="article:author" content="Moon Star">
<meta name="twitter:card" content="summary">
    
    
        
    
    
    
    
    
    <!--STYLES-->
    
<link rel="stylesheet" href="/assets/css/all.css">

    
<link rel="stylesheet" href="/assets/css/jquery.fancybox.css">

    
<link rel="stylesheet" href="/assets/css/thumbs.css">

    
<link rel="stylesheet" href="/assets/css/tranquilpeak.css">

    <!--STYLES END-->
    

    

    
</head>

    <body>
        <div id="blog">
            <!-- Define author's picture -->


    

<header id="header" data-behavior="2">
    <i id="btn-open-sidebar" class="fa fa-lg fa-bars"></i>
    <div class="header-title">
        <a
            class="header-title-link"
            href="/%20"
            aria-label=""
        >
            
        </a>
    </div>
    
        
            <a
                class="header-right-picture "
                href="#about"
                aria-label="Open the link: /#about"
            >
        
        
        </a>
    
</header>

            <!-- Define author's picture -->


<nav id="sidebar" data-behavior="2">
    <div class="sidebar-container">
        
        
            <ul class="sidebar-buttons">
            
                <li class="sidebar-button">
                    
                        <a  class="sidebar-button-link "
                             href="/%20"
                            
                            title="홈"
                        >
                    
                        <i class="sidebar-button-icon fa fa-home" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">홈</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a  class="sidebar-button-link "
                             href="/all-categories"
                            
                            title="카테고리"
                        >
                    
                        <i class="sidebar-button-icon fa fa-bookmark" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">카테고리</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a  class="sidebar-button-link "
                             href="/all-tags"
                            
                            title="태그"
                        >
                    
                        <i class="sidebar-button-icon fa fa-tags" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">태그</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a  class="sidebar-button-link "
                             href="/all-archives"
                            
                            title="아카이브"
                        >
                    
                        <i class="sidebar-button-icon fa fa-archive" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">아카이브</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a  class="sidebar-button-link open-algolia-search"
                             href="#search"
                            
                            title="검색"
                        >
                    
                        <i class="sidebar-button-icon fa fa-search" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">검색</span>
                    </a>
            </li>
            
        </ul>
        
            <ul class="sidebar-buttons">
            
                <li class="sidebar-button">
                    
                        <a  class="sidebar-button-link " href="https://github.com/" target="_blank" rel="noopener" title="GitHub">
                    
                        <i class="sidebar-button-icon fab fa-github" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">GitHub</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a  class="sidebar-button-link " href="https://facebook.com/" target="_blank" rel="noopener" title="Facebook">
                    
                        <i class="sidebar-button-icon fab fa-facebook" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Facebook</span>
                    </a>
            </li>
            
        </ul>
        
            <ul class="sidebar-buttons">
            
                <li class="sidebar-button">
                    
                        <a  class="sidebar-button-link "
                             href="/atom.xml"
                            
                            title="RSS"
                        >
                    
                        <i class="sidebar-button-icon fa fa-rss" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">RSS</span>
                    </a>
            </li>
            
        </ul>
        
    </div>
</nav>

            
            <div id="main" data-behavior="2"
                 class="
                        hasCoverMetaIn
                        ">
                
    <section class="postShorten-group main-content-wrap">
    
    
    <article class="postShorten postShorten--thumbnailimg-bottom">
        <div class="postShorten-wrap">
            
            <div class="postShorten-header">
                <h1 class="postShorten-title">
                    
                        <a
                            class="link-unstyled"
                            href="/2020/03/14/vuex-test-md/"
                            aria-label=": Vuex를 사용한 테스트"
                        >
                            Vuex를 사용한 테스트
                        </a>
                    
                </h1>
                <div class="postShorten-meta">
    <time datetime="2020-03-14T11:35:32+09:00">
	
		    Mar 14, 2020
    	
    </time>
    
        <span>in </span>
        
    <a class="category-link" href="/categories/javascript/">javascript</a>, <a class="category-link" href="/categories/javascript/TDD/">TDD</a>, <a class="category-link" href="/categories/javascript/TDD/vue-test-utils/">vue-test-utils</a>


    
</div>

            </div>
            
                <div class="postShorten-content">
                    <h2 id="Vuex를-사용하는-컴포넌트-테스트"><a href="#Vuex를-사용하는-컴포넌트-테스트" class="headerlink" title="Vuex를 사용하는 컴포넌트 테스트"></a>Vuex를 사용하는 컴포넌트 테스트</h2><h4 id="actions를-mock-하기"><a href="#actions를-mock-하기" class="headerlink" title="actions를 mock 하기"></a>actions를 mock 하기</h4><p>아래의 컴포넌트는 vuex의 actions를 사용하는 코드이다. Vuex를 사용하는 컴포넌트를 테스트시에 주의해야 할 점은 actions가 어떻게 동작하는지는 중요하지 않다. 우리가 사용하고자 하는 action이 실제로 호출되었는지 여부만 테스트 한다.<br>action이 정확하게 동작하는지 여부는 vuex store 테스트시에 하게 된다.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">    &lt;div class&#x3D;&quot;text-align-center&quot;&gt;</span><br><span class="line">        &lt;input type&#x3D;&quot;text&quot; @input&#x3D;&quot;actionInputIfTrue&quot;&gt;</span><br><span class="line">        &lt;button @click&#x3D;&quot;actionClick()&quot;&gt;Click&lt;&#x2F;button&gt;    </span><br><span class="line">    &lt;&#x2F;div&gt;</span><br><span class="line">&lt;&#x2F;template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script lang&#x3D;&quot;ts&quot;&gt;</span><br><span class="line">import &#123; Component, Vue &#125; from &#39;vue-property-decorator&#39;;</span><br><span class="line">import &#123; mapActions &#125; from &#39;vuex&#39;</span><br><span class="line"></span><br><span class="line">@Component(&#123;</span><br><span class="line">    methods: &#123;</span><br><span class="line">        ...mapActions([&#39;actionClick&#39;])</span><br><span class="line">    &#125;,</span><br><span class="line">&#125;)</span><br><span class="line">export default class Actions extends Vue &#123;</span><br><span class="line">    actionInputIfTrue(event:any):void &#123;</span><br><span class="line">        const inputValue &#x3D; event.target.value;</span><br><span class="line">        if (inputValue &#x3D;&#x3D;&#x3D; &#39;input&#39;) &#123;</span><br><span class="line">            this.$store.dispatch(&#39;actionInput&#39;, &#123; inputValue &#125;);</span><br><span class="line">        &#125; </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">&lt;&#x2F;script&gt;</span><br></pre></td></tr></table></figure>

<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; shallowMount, createLocalVue, Wrapper &#125; <span class="keyword">from</span> <span class="string">'@vue/test-utils'</span>;</span><br><span class="line"><span class="keyword">import</span> Vuex <span class="keyword">from</span> <span class="string">'vuex'</span>;</span><br><span class="line"><span class="keyword">import</span> Actions <span class="keyword">from</span> <span class="string">'../Actions.vue'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> localVue = createLocalVue();</span><br><span class="line"></span><br><span class="line">localVue.use(Vuex);</span><br><span class="line"></span><br><span class="line">describe(<span class="string">'Actions.vue'</span>, <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">let</span> wrapper:Wrapper&lt;Vue&gt;;</span><br><span class="line">    <span class="keyword">let</span> actions:<span class="built_in">any</span>;</span><br><span class="line">    <span class="keyword">let</span> store:<span class="built_in">any</span>;</span><br><span class="line"></span><br><span class="line">    beforeEach(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">        actions = &#123;</span><br><span class="line">            actionClick: jest.fn(),</span><br><span class="line">            actionInput: jest.fn()</span><br><span class="line">        &#125;;</span><br><span class="line"></span><br><span class="line">        store = <span class="keyword">new</span> Vuex.Store(&#123;</span><br><span class="line">            actions,</span><br><span class="line">        &#125;);</span><br><span class="line"></span><br><span class="line">        wrapper = shallowMount(VuexComponent, &#123; store, localVue &#125;);</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">    it(<span class="string">'dispatches "actionInput" when input event value is "input"'</span>, <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">const</span> input = wrapper.find(<span class="string">'input'</span>);</span><br><span class="line">        input.element.value = <span class="string">'input'</span>;</span><br><span class="line">        input.trigger(<span class="string">'input'</span>);</span><br><span class="line">        expect(actions.actionInput).toHaveBeenCalled();</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">    it(<span class="string">'does not dispatch "actionInput" when event value is not "input"'</span>, <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">const</span> input = wrapper.find(<span class="string">'input'</span>);</span><br><span class="line">        input.element.value = <span class="string">'no input'</span>;</span><br><span class="line">        input.trigger(<span class="string">'input'</span>);</span><br><span class="line">        expect(actions.actionInput).not.toHaveBeenCalled();</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">    it(<span class="string">'calls store action "actionClick" when button is clicked'</span>, <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">const</span> button = wrapper.find(<span class="string">'button'</span>);</span><br><span class="line">        button.trigger(<span class="string">'click'</span>);</span><br><span class="line">        expect(actions.actionClick).toHaveBeenCalled();</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<br>

<p><code>첫번째</code> 주의해야 할 점은 테스트 시에는 localVue를 사용해야 한다는 것이다.<br><code>두번째</code> 는 actions를 jest의 mock functions를 사용하여 테스트한다. 이를 이용하면 actions를 실제로 구현하지 않아도 호출되었는지 여부를 확인 할수 있다.<br><code>세번째</code> 는 함수의 호출 여부를 확인 하는 assertion은 <code>toHaveBeenCalled</code>를 사용한다.</p>
<br>

<h4 id="getters를-mock-하기"><a href="#getters를-mock-하기" class="headerlink" title="getters를 mock 하기"></a>getters를 mock 하기</h4><p>getters도 actions와 마찬가지로 어떻게 동작하는지는 중요하지 않다. getters의 결과가 실제로 렌더링 되는지 여부만 확인 해보면 된다.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">    &lt;div&gt;</span><br><span class="line">        &lt;p v-if&#x3D;&quot;inputValue&quot;&gt;&#123;&#123;inputValue&#125;&#125;&lt;&#x2F;p&gt;</span><br><span class="line">        &lt;p v-if&#x3D;&quot;clicks&quot;&gt;&#123;&#123;clicks&#125;&#125;&lt;&#x2F;p&gt;</span><br><span class="line">    &lt;&#x2F;div&gt;</span><br><span class="line">&lt;&#x2F;template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">    import &#123; mapGetters &#125; from &#39;vuex&#39;</span><br><span class="line"></span><br><span class="line">    @Component(&#123;</span><br><span class="line">        computed: mapGetters([&#39;clicks&#39;, &#39;inputValue&#39;])</span><br><span class="line">    &#125;)</span><br><span class="line">    export default class Getters extends Vue &#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&lt;&#x2F;script&gt;</span><br></pre></td></tr></table></figure>

<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; shallowMount, createLocalVue, Wrapper &#125; <span class="keyword">from</span> <span class="string">'@vue/test-utils'</span>;</span><br><span class="line"><span class="keyword">import</span> Vuex <span class="keyword">from</span> <span class="string">'vuex'</span>;</span><br><span class="line"><span class="keyword">import</span> Getters <span class="keyword">from</span> <span class="string">'../Getters.vue'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> localVue = createLocalVue();</span><br><span class="line"></span><br><span class="line">localVue.use(Vuex);</span><br><span class="line"></span><br><span class="line">describe(<span class="string">'Getters.vue'</span>, <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">let</span> getters:<span class="built_in">any</span>;</span><br><span class="line">    <span class="keyword">let</span> store:<span class="built_in">any</span>;</span><br><span class="line">    <span class="keyword">let</span> wrapper:Wrapper&lt;Vue&gt;;</span><br><span class="line"></span><br><span class="line">    beforeEach(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">        getters = &#123;</span><br><span class="line">            clicks: <span class="function"><span class="params">()</span> =&gt;</span> <span class="number">2</span>,</span><br><span class="line">            inputValue: <span class="function"><span class="params">()</span> =&gt;</span> <span class="string">'input'</span></span><br><span class="line">        &#125;;</span><br><span class="line">        store = <span class="keyword">new</span> Vuex.Store(&#123;</span><br><span class="line">            getters</span><br><span class="line">        &#125;);</span><br><span class="line">        wrapper = shallowMount(VuexComponent, &#123; store, localVue &#125;);</span><br><span class="line">    &#125;);</span><br><span class="line">    </span><br><span class="line">    it(<span class="string">'Renders "store.getters.inputValue" in first p tag'</span>, <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">        expect(wrapper.find(<span class="string">'.input-value'</span>).text()).toBe(getters.inputValue());</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">    it(<span class="string">'Renders "store.getters.clicks" in second p tag'</span>, <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">        expect(wrapper.findAll(<span class="string">'p'</span>).at(<span class="number">1</span>).text()).toBe(getters.clicks().toString());</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<br>

<p><code>첫번째</code> 는 actions와는 달리 getters는 jest의 mock functions를 사용하지 않는다. getters 객체를 작성하지만 로직은 중요하지 않는다.<br><code>두번째</code> 는 getters의 리턴 값이 렌더링되었는지 여부를 확인 하는 건 wrapper의 text 메소드를 이용한다.</p>
<br>

<h4 id="vuex의-모듈-방식-테스트하기"><a href="#vuex의-모듈-방식-테스트하기" class="headerlink" title="vuex의 모듈 방식 테스트하기"></a>vuex의 모듈 방식 테스트하기</h4><p>vuex의 모듈 방식을 활용한 테스트도 기존의 테스트랑 별 다를게 없다.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">    &lt;div&gt;</span><br><span class="line">        &lt;button @click&#x3D;&quot;moduleActionClick()&quot;&gt;Click&lt;&#x2F;button&gt;</span><br><span class="line">        &lt;p&gt;&#123;&#123;moduleClicks&#125;&#125;&lt;&#x2F;p&gt;</span><br><span class="line">    &lt;&#x2F;div&gt;</span><br><span class="line">&lt;&#x2F;template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">import &#123; Vue, Component &#125; from &#39;vue-property-decorator&#39;;</span><br><span class="line">import &#123; mapActions, mapGetters &#125; from &#39;vuex&#39;;</span><br><span class="line"></span><br><span class="line">@Component(&#123;</span><br><span class="line">    methods: &#123;</span><br><span class="line">        ...mapActions([&#39;moduleActionClick&#39;])</span><br><span class="line">    &#125;,</span><br><span class="line">    computed: mapGetters([&#39;moduleClicks&#39;])</span><br><span class="line">&#125;)</span><br><span class="line">export default class MyModuleVuex extends Vue &#123;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br><span class="line">&lt;&#x2F;script&gt;</span><br></pre></td></tr></table></figure>

<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; shallowMount, createLocalVue, Wrapper &#125; <span class="keyword">from</span> <span class="string">'@vue/test-utils'</span>;</span><br><span class="line"><span class="keyword">import</span> Vuex <span class="keyword">from</span> <span class="string">'vuex'</span>;</span><br><span class="line"><span class="keyword">import</span> MyModuleVuex <span class="keyword">from</span> <span class="string">'../MyModuleVuex.vue'</span>;</span><br><span class="line"><span class="keyword">import</span> myModule <span class="keyword">from</span> <span class="string">'../../store/myModule'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> localVue = createLocalVue();</span><br><span class="line"></span><br><span class="line">localVue.use(Vuex);</span><br><span class="line"></span><br><span class="line">describe(<span class="string">'MyModuleVuex'</span>, <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">let</span> actions:<span class="built_in">any</span>;</span><br><span class="line">    <span class="keyword">let</span> state:<span class="built_in">any</span>;</span><br><span class="line">    <span class="keyword">let</span> store:<span class="built_in">any</span>;</span><br><span class="line">    <span class="keyword">let</span> wrapper:Wrapper&lt;Vue&gt;;</span><br><span class="line"></span><br><span class="line">    beforeEach(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">        actions = &#123;</span><br><span class="line">            moduleActionClick: jest.fn()</span><br><span class="line">        &#125;;</span><br><span class="line">        state = &#123;</span><br><span class="line">            clicks: <span class="number">2</span></span><br><span class="line">        &#125;;</span><br><span class="line">        store = <span class="keyword">new</span> Vuex.Store(&#123;</span><br><span class="line">            modules: &#123;</span><br><span class="line">                myModule: &#123;</span><br><span class="line">                    state,</span><br><span class="line">                    actions,</span><br><span class="line">                    getters: myModule.getters</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">        wrapper = shallowMount(MyModuleVuex, &#123; store, localVue &#125;);</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">    it(<span class="string">'calls store action "moduleActionClick" when button is clicked'</span>, <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">        wrapper.find(<span class="string">'button'</span>).trigger(<span class="string">'click'</span>);</span><br><span class="line">        expect(actions.moduleActionClick).toHaveBeenCalled();</span><br><span class="line">    &#125;)</span><br><span class="line"></span><br><span class="line">    it(<span class="string">'renders "state.clicks" in first p tag'</span>, <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">        expect(wrapper.find(<span class="string">'p'</span>).text()).toBe(state.clicks.toString());</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<br>

<h2 id="Vuex-Store-테스트하기"><a href="#Vuex-Store-테스트하기" class="headerlink" title="Vuex Store 테스트하기"></a>Vuex Store 테스트하기</h2><p>지금까지는 Vuex를 사용하는 컴포넌트에 대해서 알아보았다. 그렇기 때문에 실제 Vuex의 내부 동작과는 무관한 테스트였다. 이번에는 Vuex가 정확하게 동작하는지 여부를 테스트 하기 위한 방법이다.<br>Vuex Store 테스트는 두가지 방법이 있다. 첫번째는 getters, mutations, actions를 독립적으로 테스트 하는 것이다. 두번째는 실제 Vuex Store를 생성하는 방법이다.<br>아래는 테스트에서 사용할 mutations와 getters 코드이다.</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">    increment(state:<span class="built_in">any</span>) &#123;</span><br><span class="line">        state.count++;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">    evenOrOdd(state:<span class="built_in">any</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> state.count % <span class="number">2</span> === <span class="number">0</span> ? <span class="string">'even'</span> : <span class="string">'odd'</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<br>

<h4 id="getters-mutations-actions를-독립적으로-테스트하기"><a href="#getters-mutations-actions를-독립적으로-테스트하기" class="headerlink" title="getters, mutations, actions를 독립적으로 테스트하기"></a>getters, mutations, actions를 독립적으로 테스트하기</h4><p>독립적으로 테스트 하는 경우에는 좀더 상세하게 테스트를 진행할수 있다. 테스트가 실패하더라도 어디에서 실패했는지 찾기가 쉽다. 단점으로는 commit, dispatch같은 Vuex의 함수들을 mock 해야할 필요가 있다. 이는 유닛 테스트는 성공할지라도 mock이 정확하지 않기 때문에 실제 production 코드는 실패할수도 있다.</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> mutations <span class="keyword">from</span> <span class="string">'../mutations'</span>;</span><br><span class="line"></span><br><span class="line">test(<span class="string">'"increment" increments "state.count" by 1'</span>, <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> state = &#123; count: <span class="number">1</span> &#125;;</span><br><span class="line">    mutations.increment(state);</span><br><span class="line">    expect(state.count).toBe(<span class="number">2</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> getters <span class="keyword">from</span> <span class="string">'../getters'</span>;</span><br><span class="line"></span><br><span class="line">test(<span class="string">'"evenOrOdd" returns even if "state.count" is even'</span>, <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> state = &#123; count: <span class="number">2</span> &#125;;</span><br><span class="line">    expect(getters.evenOrOdd(state)).toBe(<span class="string">'even'</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">test(<span class="string">'"evenOrOdd" returns odd if "state.count" is odd'</span>, <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> state = &#123; count: <span class="number">1</span> &#125;;</span><br><span class="line">    expect(getters.evenOrOdd(state)).toBe(<span class="string">'odd'</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<br>

<h4 id="store를-사용한-테스트"><a href="#store를-사용한-테스트" class="headerlink" title="store를 사용한 테스트"></a>store를 사용한 테스트</h4><p>실제로 Vuex sotre를 사용한 방법이다. 이 테스트의 장점은 Vuex function들을 mock 할 필요가 없다는 것이다. 하지만 테스트 실패시에 어디에서 문제가 발생했는지 찾기가 어렵다.</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> mutations <span class="keyword">from</span> <span class="string">'./mutations'</span>;</span><br><span class="line"><span class="keyword">import</span> getters <span class="keyword">from</span> <span class="string">'./getters'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">    state: &#123;</span><br><span class="line">        count: <span class="number">0</span></span><br><span class="line">    &#125;,</span><br><span class="line">    mutations,</span><br><span class="line">    getters</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; createLocalVue &#125; <span class="keyword">from</span> <span class="string">'@vue/test-utils'</span>;</span><br><span class="line"><span class="keyword">import</span> Vuex <span class="keyword">from</span> <span class="string">'vuex'</span>;</span><br><span class="line"><span class="keyword">import</span> storeConfig <span class="keyword">from</span> <span class="string">'../store-config'</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; cloneDeep &#125; <span class="keyword">from</span> <span class="string">'lodash'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> localVue = createLocalVue();</span><br><span class="line"><span class="keyword">let</span> store:<span class="built_in">any</span>;</span><br><span class="line">localVue.use(Vuex);</span><br><span class="line"></span><br><span class="line">beforeEach(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">    store = <span class="keyword">new</span> Vuex.Store(cloneDeep(storeConfig));</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">test(<span class="string">'increments "count" value when "increment" is committed'</span>, <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">    expect(store.state.count).toBe(<span class="number">0</span>);</span><br><span class="line">    store.commit(<span class="string">'increment'</span>);</span><br><span class="line">    expect(store.state.count).toBe(<span class="number">1</span>);</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">test(<span class="string">'updates "evenOrOdd" getter when "increment" is committed'</span>, <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">    expect(store.getters.evenOrOdd).toBe(<span class="string">'even'</span>);</span><br><span class="line">    store.commit(<span class="string">'increment'</span>);</span><br><span class="line">    expect(store.getters.evenOrOdd).toBe(<span class="string">'odd'</span>);</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<p>해당 테스트에서는 cloneDeep를 사용하고 있는데 이는 각 테스트에 store를 클린하게 사용하기 위해서 이다.</p>
<p>그리고 생각해 보았을 때 상황에 맞추어서 하나씩만 적용 하던가 아니면 두개 모두를 적용해서 테스트 코드를 작성 하면 좋을거 같다.</p>

                    
                        


                    
                    
                        <p>
                            <a
                                href="/2020/03/14/vuex-test-md/#post-footer"
                                class="postShorten-excerpt_link link"
                                aria-label=""
                            >
                                Comment and share
                            </a>
                        </p>
                    
                </div>
            
        </div>
        
    </article>
    
    
    <article class="postShorten postShorten--thumbnailimg-bottom">
        <div class="postShorten-wrap">
            
            <div class="postShorten-header">
                <h1 class="postShorten-title">
                    
                        <a
                            class="link-unstyled"
                            href="/2020/03/13/vue-router-test/"
                            aria-label=": Vue 라우터 테스트"
                        >
                            Vue 라우터 테스트
                        </a>
                    
                </h1>
                <div class="postShorten-meta">
    <time datetime="2020-03-13T17:14:15+09:00">
	
		    Mar 13, 2020
    	
    </time>
    
        <span>in </span>
        
    <a class="category-link" href="/categories/javascript/">javascript</a>, <a class="category-link" href="/categories/javascript/TDD/">TDD</a>, <a class="category-link" href="/categories/javascript/TDD/vue-test-utils/">vue-test-utils</a>


    
</div>

            </div>
            
                <div class="postShorten-content">
                    <h2 id="vue-라우터-테스트-시에-주의-할점"><a href="#vue-라우터-테스트-시에-주의-할점" class="headerlink" title="vue 라우터 테스트 시에 주의 할점"></a>vue 라우터 테스트 시에 주의 할점</h2><p>vue 라우터를 테스트 할 시에 global Vue에 직접 추가를 해서는 안된다. vue 라우터를 설치 할 경우에는 $route와 $router가 vue 프로퍼티에 추가되어진다. 이는 $route와 $router를 mock 해서 테스트 하는 경우에 테스트를 실패하게 만든다.<br>vue-test-utils에서 제공하는 createLocalVue을 사용하는 것을 권장한다.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; shallowMount, createLocalVue &#125; <span class="keyword">from</span> <span class="string">'@vue/test-utils'</span></span><br><span class="line"><span class="keyword">import</span> VueRouter <span class="keyword">from</span> <span class="string">'vue-router'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> localVue = createLocalVue()</span><br><span class="line">localVue.use(VueRouter)</span><br><span class="line"><span class="keyword">const</span> router = <span class="keyword">new</span> VueRouter()</span><br><span class="line"></span><br><span class="line">shallowMount(Component, &#123;</span><br><span class="line">    localVue,</span><br><span class="line">    router</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<br>

<h2 id="router-link-router-view를-사용하는-컴포넌트-테스트-하기"><a href="#router-link-router-view를-사용하는-컴포넌트-테스트-하기" class="headerlink" title="router-link, router-view를 사용하는 컴포넌트 테스트 하기"></a>router-link, router-view를 사용하는 컴포넌트 테스트 하기</h2><p>위 두가지 컴포넌트를 사용하는 컴포넌트를 테스트 하는 방법은 두가지가 존재한다.</p>
<br>

<h4 id="1-stubs-사용하기"><a href="#1-stubs-사용하기" class="headerlink" title="1. stubs 사용하기"></a>1. stubs 사용하기</h4><p>stubs를 사용해서 자식 컴포넌트를 렌더링하는 것을 피한다.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; shallowMount &#125; <span class="keyword">from</span> <span class="string">'@vue/test-utils'</span></span><br><span class="line"></span><br><span class="line">shallowMount(Component, &#123;</span><br><span class="line">    stubs: [<span class="string">'router-link'</span>, <span class="string">'router-view'</span>]</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<br>

<h4 id="2-localVue를-사용하기"><a href="#2-localVue를-사용하기" class="headerlink" title="2. localVue를 사용하기"></a>2. localVue를 사용하기</h4><p>localVue를 이용해서 실제로 VueRouoter를 추가하는 방식이다.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; shallowMount, createLocalVue &#125; <span class="keyword">from</span> <span class="string">'@vue/test-utils'</span></span><br><span class="line"><span class="keyword">import</span> VueRouter <span class="keyword">from</span> <span class="string">'vue-router'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> localVue = createLocalVue();</span><br><span class="line">localVue.use(VueRouter);</span><br><span class="line"></span><br><span class="line">shallowMount(Component, &#123;</span><br><span class="line">    localVue</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<br>

<h2 id="route-router-mock-하기"><a href="#route-router-mock-하기" class="headerlink" title="$route, $router mock 하기"></a>$route, $router mock 하기</h2><p>$route, $router 객체를 가지고 컴포넌트 테스트를 해야 할 경우가 있다. 이때는 $route, $router를 mock 하여 사용한다.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; shallowMount &#125; <span class="keyword">from</span> <span class="string">'@vue/test-utils'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> $route = &#123;</span><br><span class="line">    path: <span class="string">'/some/path'</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> wrapper = shallowMount(Component, &#123;</span><br><span class="line">    mocks: &#123;</span><br><span class="line">        $route</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">wrapper.vm.$route.path  <span class="comment">// 이렇게 접근이 가능해진다.</span></span><br></pre></td></tr></table></figure>




                    
                        


                    
                    
                        <p>
                            <a
                                href="/2020/03/13/vue-router-test/#post-footer"
                                class="postShorten-excerpt_link link"
                                aria-label=""
                            >
                                Comment and share
                            </a>
                        </p>
                    
                </div>
            
        </div>
        
    </article>
    
    <div class="pagination-bar">
    <ul class="pagination">
        
        
        <li class="pagination-number">page 1 of 1</li>
    </ul>
</div>

</section>



                <footer id="footer" class="main-content-wrap">
    <span class="copyrights">
        Copyrights &copy; 2020 Moon Star. All Rights Reserved.
    </span>
</footer>

            </div>
            
        </div>
        


<div id="about">
    <div id="about-card">
        <div id="about-btn-close">
            <i class="fa fa-times"></i>
        </div>
        
            <h4 id="about-card-name">Moon Star</h4>
        
            <div id="about-card-bio"><p>author.bio</p>
</div>
        
        
            <div id="about-card-job">
                <i class="fa fa-briefcase"></i>
                <br/>
                <p>author.job</p>

            </div>
        
        
    </div>
</div>

        
        
<div id="cover" style="background-image:url('/assets/images/cover.jpg');"></div>
        <!--SCRIPTS-->

<script src="/assets/js/jquery.js"></script>


<script src="/assets/js/jquery.fancybox.js"></script>


<script src="/assets/js/thumbs.js"></script>


<script src="/assets/js/tranquilpeak.js"></script>

<!--SCRIPTS END-->





    </body>
</html>
